---
title: "Writing Functions in R"
subtitle: "RStudio Instructor Certification Teaching Exam"
author: "Sharla Gelfand"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["xaringan-themer.css", "pull.css"]
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: 16:9
---
class: center

```{r, include = FALSE}
library(flair)

library(xaringanthemer)
style_duo_accent(
  primary_color = "#1F4257",
  secondary_color = "#F97B64",
  text_slide_number_font_size = "0em"
)
```

### You already know how to use functions!

--

.pull-left[
Reading a CSV...

`read_csv()`
]

--

.pull-right[
Calculating a mean...

`mean()`
]

--

.pull-left[
Making a plot...

`ggplot() + 
  geom_point()`
]

--

.pull-right[
Fitting a model...

`lm(y~x)`
]

--

Functions help you organize and reuse code.

Now let's write our own! 

???

As an R user, you already know how to use functions! Functions enable everything we do in R

Functions allow you to better organize and reuse your code - so today we're going to learn how to write our own.

---

I love to cook!

Americans give measurements in ounces.

--

```{r}
8 * 28.349
```

--

```{r}
16 * 28.349
``` 

--

If I only had an R function instead of doing the same thing over and over

---

## Let's write one!

--

```{r}
convert_ounces_to_grams <- function(ounces) {
  ounces * 28.349
}
```

--

```{r}
convert_ounces_to_grams(ounces = 8)
convert_ounces_to_grams(ounces = 16)
```

---

# Components of a function

A function has a **name**:

```{r initial-function, include = FALSE}
convert_ounces_to_grams <- function(ounces) {
  ounces * 28.349
}
```

```{r, echo = FALSE}
decorate("initial-function") %>% 
  flair("convert_ounces_to_grams")
```

---

# Components of a function

A function takes **arguments**:

```{r, echo = FALSE}
decorate("initial-function") %>% 
  flair_rx("(?<=\\().+?(?=\\))")
```

---

# Components of a function

The **body** of a function is used for computations:

```{r, echo = FALSE}
decorate("initial-function") %>% 
  flair("ounces * 28.349")
```

---

# Naming functions

Clearly and meaningfully - write code that is easier to understand!

`convert_ounces_to_grams`

--

I like **snake_case**, some people like **camelCase** - use whatever feels right!

???

Functions should be named clearly and meaningfully, to help yourself write (and read!) code that is easier to understand - the names are for people as much as for computers!

convert_oz_to_grams()

I like to use snake_case, but some people like camelCase - use whatever feels right for you!

---
class: inverse, center, middle

# Time for an exercise!

--

Imagine you're writing a function to convert kilograms to pounds.

Which name would you choose for your function?

`weight_converter()`

`convert_kg_to_lb()`

`kgtolb()`

`Kilogram_ToPounds()`

---

# Arguments

**Data**: what the function works on

```{r data-argument, include = FALSE}
convert_ounces_to_grams(ounces = 8)
```

```{r, echo = FALSE}
decorate_chunk("data-argument") %>%
  flair("ounces = 8")
```

**Details**: how the computation is run

```{r details-argument, include = FALSE}
convert_ounces_to_grams <- function(ounces, digits) {
  round(ounces * 28.349, digits = digits)
}
```

```{r, echo = FALSE}
decorate_chunk("details-argument") %>%
  flair("digits)")
```


```{r}
convert_ounces_to_grams(ounces = 8, digits = 0)
```

---
# Calling arguments

It can be verbose to specify `ounces` every time!

--

You don't have to name the arguments if you're supplying them in the order they were defined

```{r}
convert_ounces_to_grams(8, 0)
```

--

But sometimes that makes your code tough to understang

```{r}
convert_ounces_to_grams(8, digits = 0)
```

--

Data first, details after.

---

Exercise on arguments and orders

---

# Default arguments

A **default** value that your function uses for an argument if nothing is supplied

--

```{r default-arguments, include = FALSE}
convert_ounces_to_grams <- function(ounces, digits = 0) {
  round(ounces * 28.349, digits = digits)
}
```

```{r, echo = FALSE}
decorate_chunk("default-arguments") %>%
  flair("digits = 0")
```

--

```{r}
convert_ounces_to_grams(ounces = 8)
```

--

Set the default to the value you want most often!

--

If you're using another well-known function, it's a good idea to have the defaults match!

```{r}
round(1.9)
```

---

# Function body

The **body** of a function contains all calculations.

```{r body, include = FALSE}
convert_ounces_to_grams <- function(ounces, digits = 0) {
  round(ounces * 28.349, digits = digits)
}
```

```{r, echo = FALSE}
decorate_chunk("body") %>%
  flair("round(ounces * 28.349, digits = digits)")
```

---

# Function body

The body of a function is **self contained**.

Can write comments, create intermediate variables, just like in the rest of the code we write.

If your function is complicated, best to split up the different steps and explain what's going on.

```{r body-complicated, include = FALSE}
convert_ounces_to_grams <- function(ounces, digits = 0) {
  grams <- ounces * 28.349
  
  # Apply rounding
  round(grams, digits = digits)
}
```

```{r, echo = FALSE}
decorate_chunk("body-complicated") %>%
  flair("grams <- ounces * 28.349") %>%
  flair("# Apply rounding")
```


---

# Function body

Function returns the last value computed by default.

```{r body-return, include = FALSE}
convert_ounces_to_grams <- function(ounces, digits = 0) {
  grams <- ounces * 28.349
  
  # Apply rounding
  round(grams, digits = digits)
}
```

```{r, echo = FALSE}
decorate_chunk("body-return") %>%
  flair("round(grams, digits = digits)")
```

---

# Function body

Sometimes you don't need to go through the whole function.

What is 0 ounces?

--

```{r, return-early, include = FALSE}
convert_ounces_to_grams <- function(ounces, digits = 0) {
  if (ounces == 0) {
    return(0)
  }
  
  grams <- ounces * 28.349
  
  # Apply rounding
  round(grams, digits = digits)
}
```


```{r, echo = FALSE}
decorate_chunk("return-early") %>%
  flair("if (ounces == 0) {
    return(0)
  }")
```


```{r}
convert_ounces_to_grams(0)
```


---

# Wrapping up

```{r}
convert_ounces_to_grams <- function(ounces, digits = 0) {
  round(ounces * 28.349, digits = digits)
}
```

Functions are **named** meaningfully to help you write easier to understand code.

They take **arguments** which dictate what data your function is run on and the details of how it's run.

They have a **body**, which can contain complicated calculations, but is self contained.
